<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundle.AppName}"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <h:form prependId="false">
                <p:layout fullPage="false" style="width: 99.9%;height: 99.9%;min-height: 800px">
                    <p:layoutUnit position="west" size="180" style="height: 300px" >

                        <h:panelGrid  columns="1" style="text-align: center; " >
                            <p:menu >
                                <p:submenu label="Calendars" >  
                                    <p:menuitem value="All Events" action="#{calendarBean.getAllEventsUser()}" ajax="false" icon="ui-icon-home"/>  
                                    <p:menuitem value="Personal Events" action="#{calendarBean.getEventsPersonal()}" ajax="false" icon="ui-icon-star"/>  
                                </p:submenu> 
                                <p:submenu label="Subjects Events">  
                                    <c:forEach var="subject" items="#{calendarBean.getAllSubjectsCurrentUser()}" >
                                        <p:menuitem value="#{subject.nombre}" action="#{calendarBean.getEventsSubject(subject)}" ajax="false" icon="ui-icon-note"/>  
                                    </c:forEach> 
                                </p:submenu>  
                            </p:menu>   
                        </h:panelGrid>
                    </p:layoutUnit>
                    <p:layoutUnit position="center" size="300" style="height: 300px">

                        <p:schedule value="#{calendarBean.eventModel}" widgetVar="myschedule" style="width: 85%;  margin: auto;" >
                            <p:ajax event="dateSelect" listener="#{calendarBean.onDateSelect}" update="eventDetails" oncomplete="eventDialog.show()" />
                            <p:ajax event="eventSelect" listener="#{calendarBean.onEventSelect}"/>
                        </p:schedule>
                            <p:dialog widgetVar="eventDialog" header="Event Details" resizable="false" >
                                <h:panelGrid id="eventDetails" columns="2">
                                    <h:outputLabel for="titulo" value="Title:" />
                                    <h:inputText id="titulo" value="#{calendarBean.event.title}" />

                                    <h:outputLabel for="from" value="From:" />
                                    <p:inputMask id="from" value="#{calendarBean.event.startDate}" mask="99/99/9999">
                                        <f:convertDateTime pattern="dd/MM/yyyy" />
                                    </p:inputMask>

                                    <h:outputLabel for="to" value="To:" />
                                    <p:inputMask id="to" value="#{calendarBean.event.endDate}" mask="99/99/9999">
                                        <f:convertDateTime pattern="dd/MM/yyyy" />
                                    </p:inputMask>

                                    <h:outputLabel for="allDay" value="All Day:" />
                                    <h:selectBooleanCheckbox id="allDay" value="#{calendarBean.event.allDay}"  />

                                    <p:commandButton type="reset" value="Reset" />
                                    <p:commandButton value="Save" actionListener="#{calendarBean.addEvent}" oncomplete="myschedule.update();eventDialog.hide();"/>
                                </h:panelGrid>
                            </p:dialog>
                    </p:layoutUnit>
                </p:layout>
            </h:form>
        </ui:define>

    </ui:composition>

</html>
